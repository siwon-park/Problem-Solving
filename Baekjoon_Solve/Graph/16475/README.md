## [골1] 수학 미로 (16475번)

https://www.acmicpc.net/problem/16475

### 문제 유형

그래프 이론, 그래프 탐색, 다익스트라

<br>

### 어려웠던 점 / 문제의 핵심

구현, 설계 실수 때문에 다 풀어놓고 헤맸다.

3차원의 최단 거리 테이블을 선언하여 다익스트라 알고리즘을 통해 문제를 해결할 수 있다.

- `distance[스위칭 On/Off][스위치 누른 횟수][노드 번호]`
- 또한 스위칭을 하면서 계속해서 왔다갔다 하다보면 이동 거리의 누적이 Integer형을 벗어날 수도 있기 때문에 Long형으로 선언해야 한다.

스위치를 `P`번 누르면 `L`개의 모든 함정 경로가 바뀌기 때문에 graph를 2개 사용해야 한다. 따라서 크기가 2인 ArrayList 배열을 선언하여 연결리스트 방식으로 그래프를 선언해야 한다.

- `ArrayList<ArrayList<Node>>[] graph`
- 0일 경우 스위치 OFF 상태 / 1일 경우 스위치 ON 상태

그리고 입력으로 받을 때, 1번 인덱스의 그래프는 경로를 역으로 삽입한다.

#### 구현

다익스트라 알고리즘은 이동 거리가 짧은 것이 더 높은 우선순위를 가지는 우선순위 큐로 구현한다.

`(현재 노드, 총 이동 거리, 스위치 누른 횟수, 경로 상태)`를 우선순위 큐에 삽입하여 그래프 탐색을 하면 된다.

만약 다음 이동할 노드가 함정 노드이면 스위치를 누른 횟수를 1증가시킨다.

- 만약에 스위치를 누른 횟수`p`가 `P`가 되면 그래프의 상태 `r`을 반전시킨다. 
  - r = 0이면 1로, r = 1이면 0이 된다. (1과 비트 반전 연산을 해도 됨)
  - 그 후, p를 P로 나눈 나머지 값으로 갱신한다. 왜냐하면 문제에서 p == P이면 스위치를 누른 횟수는 다시 0으로 초기화된다고 했기 때문이다.

이후 `distance[r][p][nxt]`와 비교하여 최단 거리를 갱신하면 된다.

#### 실수했던 점

최단 거리를 먼저 갱신하는 실수를 범했다. 그렇게 구현해도 상관 없을 것이라 생각했다.

- 먼저 함정 노드인지 확인 후, 함정 노드 여부에 따라 스위치를 누른 횟수와 그래프 상태를 변경한 다음에 갱신한 것이 아니라, 현재의 `p`, `r`값을 기준으로 최단 거리를 갱신한 다음에 함정 노드일 경우에 `p`와 `r`값을 변경하여 우선순위 큐에 삽입했다.

차이가 없을 것 같지만 40%에서 자꾸 틀렸습니다를 받는 것으로 보아, 다른 반례가 있는 것 같다. (반례는 찾지 못함)

r과 p를 먼저 변경한 다음에,  `distance[r][p][nxt]`를 갱신하니 정답이었다.

어떤 반례가 있을까, 논리적으로 어디서 잘못되었을까 고민했고 논리적으로도 이해가 되지 않았지만, `비트 마스킹 + BFS 탐색`으로 이해하니 보다 쉽게 이해할 수 있었다.

문제에서 함정 노드에 도착하면 무조건 스위치를 한 번 누른다고 했으므로, 비트 마스킹 + BFS처럼 해당 위치에 도착하면 비트 연산을 한 다음 (변경된 새로운) 비트의 방문 배열을 체크/비교하는 것처럼, 이 문제에서도 함정 노드에 도착하고 나면 스위치를 누른 횟수 + 1, (변경된 새로운) 그래프 상태의 distance 배열을 사용해야 하는 것이다.

<br>

### 언어별 풀이 요약

| 언어   | 메모리   | 실행 시간(ms) | 시간복잡도 | 공간복잡도 | 풀이 시간 | 시도 횟수 | 해설 참고          |
| ------ | -------- | ------------- | ---------- | ---------- | --------- | --------- | ------------------ |
| Python |          |               |            |            |           |           |                    |
| Java   | 30884 KB | 412 ms        | O(2M*logN) | O(N)       | 120분     | 8         | :white_check_mark: |
| Kotlin |          |               |            |            |           |           |                    |

<br>

### 예외(테스트) 케이스

```
```


## [플5] 이미지 보정 작업 (27068번)

https://www.acmicpc.net/problem/27068

### 문제 유형

그래프 이론, 그래프 탐색, BFS, 이분 탐색(매개 변수 탐색)

<br>

### 어려웠던 점 / 문제의 핵심

매개 변수 탐색 + BFS로 풀 수 있지만, 굳이 강제적으로 BFS를 사용할 필요가 없다.

매개 변수 탐색 + 조건부 완전 탐색으로도 문제를 충분히 풀 수 있다. N과 M의 최대 크기가 500이기 때문에 MN을 고려했을 때는 전혀 작은 크기가 아니지만, 제한 시간이 3초이기 때문에 충분히 풀 수 있다.

매개 변수 탐색으로 찾을 대상은 인접한 칸 차이의 최댓값 중 최솟값이다.

`mid`를 인접한 칸 차이의 최댓값이라고 했을 때, 모든 영역을 전부 탐색할 수 있느냐 (BFS로 모든 곳을 탐색할 수 있느냐)가 핵심이다.

하지만 이 문제에서 가장 크게 걸리는 것은 최대 `K`번까지 이미지를 보정하여 `X`값으로 변경할 수 있다는 점이다.

그러면 우리가 여기서 중요하게 여겨야 할 것은 언제 이미지를 보정해야 하는가이다. 당연히 인접한 칸의 차이가 mid값을 넘어섰을 때 이미지 보정이 필요한데, 고려해야 할 점은

- 현재 위치(y, x)의 이미지를 변경할 것인가?
- 다음 위치(ny, nx)의 이미지를 변경할 것인가?

이다.

- 현재 위치(y, x)의 이미지를 보정하는 경우
  - 현재 위치의 크기가 다음 위치의 크기 이하인 경우에 현재 위치의 값을 X로 보정한다.
  - 왜냐하면 그래야 두 위치의 차이의 절댓값이 줄어들기 때문이다. 다음 위치가 더 큰데 배열 상에서 최댓값인 X로 보정해봤자 두 위치의 차이의 절댓값만 더 커지게 된다.
- 다음 위치(ny, nx)의 이미지를 보정하는 경우
  - 다음 위치의 크기가 현재 위치보다 작은 경우에 다음 위치의 값을 X로 보정한다.

위의 로직을 반영하여 탐색을 구현하면 문제를 풀 수 있다.

BFS가 풀이 속도는 느리면서, 구현하기 더 까다롭다. 왜냐하면 이미지를 보정하는 타겟을 오직 현재 위치나 오직 다음 위치 한쪽으로만 고정시켜서 계산해야 하고, 이 때의 이미지 보정을 하지 않아도 되는 경우를 고려해야 하기 때문이다.

- 조건을 만족하지 않았을 때, 현재 위치의 이미지를 보정한다고 기준을 세우면
- 다음 위치를 X로 바꿨을 때 `X - 현재 위치의 값 <= mid`를 만족하면 현재 위치의 값을 바꿀 필요가 없다.
  - 위에서 설명한 로직과 같은데 표현만 달라진 것으로, 조건을 만족하지 않아서 이미지 보정이 필요하지만 현재 위치의 이미지를 보정하는 것보다 다음 위치의 이미지를 보정하는 것이 인접한 두 칸의 차이의 절댓값을 줄일 수 있기 때문에 굳이 현재 위치를 바꿀 필요가 없는 것이다.

조건부 완전 탐색으로 구현할 경우, while문 안에 2중 for 구문을 사용하여 우측과 하단의 인접한 칸에 대해서만 이미지 보정을 실시하면 된다.

- 4방향이 아니라 우측과 하단만 조건을 확인하여 보정하는 이유는 while문 안에서 계속 반복하기 때문에 조건을 만족하여 이미 지나친 곳이지만 주변에 보정된 이미지로 인해 보정이 필요한 경우의 수도 while 문이 계속되는 한 고려할 수 있기 때문이다.
- while문은 정말 많이 돌아봤자 최대 4번 돌 수 있다.

<br>

### 언어별 풀이 요약

X가 최대 10 ^ 18이기 때문에 logX는 59.7(약 60)이고, 4 * M * N은 최대 100만이기 때문에 최악의 경우의 수는 거의 6천만이다.

| 언어   | 메모리   | 실행 시간(ms) | 시간복잡도    | 공간복잡도 | 풀이 시간 | 시도 횟수 | 해설 참고          |
| ------ | -------- | ------------- | ------------- | ---------- | --------- | --------- | ------------------ |
| Python |          |               |               |            |           |           |                    |
| Java   | 54316 KB | 1104 ms       | O(logX * 4MN) | O(MN)      | 300분     | 4         | :white_check_mark: |
| Kotlin |          |               |               |            |           |           |                    |

<br>

### 예외(테스트) 케이스

예외는 아니지만 돌려보면 좋은 TC들

```
1 3 1 5
1 5 5
ans: 0
    
3 3 1 6
1 1 1
1 5 1
1 1 1
ans: 4
    
1 2 2 10
1 7
ans: 0
    
1 3 2 10
1 7 9
ans: 1
```

